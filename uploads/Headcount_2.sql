
[DB Instance: MSTR OFSAAPROD_DWHSTG]
select
from
a01.LEGAL_ENTITY_CLASSIFICATION LEGAL_ENTITY_CLASSIFICATION,
a01.NATIVE_CODE LEGAL_ENTITY_CODE DIM_LEGAL_ENTITY_NEW
a01
[DB Instance: MSTR OFSAAUAT_OFSAATM]
create table ZZOPOO(
LEGAL ENTITY_CLASSIFICATION
LEGAL_ENTITY_CODE
VARCHAR2(255),
VARCHAR2(60))
[DB Instance: MSTR OF SAAUAT_OFSAATM]
insert into ZZOPee values ([Analytical Engine Results: LEGAL_ENTITY_CLASSIFICATION, LEGAL ENTITY_CODE])
[DB Instance: MSTR OFSAAUAT_OFSAATM]
create table ZZMD01 nologging as
select
a11.YEAR_S YEAR_S,
a11.LEGAL_ENTITY_CODE LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER GRADE_ORDER,
a11.EMP_TYPE EMP_TYPE,
a11.COST CENTER_CODE COST_CENTER_CODE,
Sum(CASE WHEN a13.MONTH_ID=1 THEN a11.MONTH_01
WHEN a13.MONTH_ID=2 THEN
WHEN
a13.MONTH_ID=3 THEN
WHEN a13.MONTH_ID=4 THEN
a11.MONTH_02
a11.MONTH_03
a11.MONTH_04
WHEN a13.MONTH_ID=5 THEN a11.MONTH_05 WHEN a13.MONTH_ID=6 THEN a11.MONTH_06 WHEN a13.MONTH_ID=7 THEN a11.MONTH_07 WHEN a13.MONTH_ID=8 THEN a11.MONTH_08 WHEN a13.MONTH_ID=9 THEN
WHEN
WHEN
WHEN
a13.MONTH_ID=10 THEN
a11.MONTH_09
a11.MONTH_10
a13.MONTH_ID=11 THEN a11.MONTH_11
a13.MONTH_ID=12 THEN WJXBFS1,
a11.MONTH_12
ELSE NULL END)
WJXBFS2,
WJXBFS3,
WJXBFS4,
WJXBFS5,
sum(CASE WHEN a13.MONTH_ID>=4 THEN a11.MONTH_04 ELSE NULL END) sum (CASE WHEN a13. MONTH_ID>=8 THEN a11.MONTH 08 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=12 THEN a11. MONTH 12 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=2 THEN a11.MONTH_02 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=1 THEN a11.MONTH_01 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=7 THEN a11.MONTH 07 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=6 THEN a11.MONTH_06 ELSE NULL END) sum(CASE WHEN a13.MONTH ID>=3 THEN a11. MONTH 03 ELSE NULL END) 
WJXBFS6,
WJXBF57,
WJXBFS8,
WJXBFS9,

sum(CASE WHEN a13.MONTH_ID>=5 THEN a11.MONTH_05 ELSE NULL END) WJXBFSa, sum(CASE WHEN a13.MONTH_ID>=11 THEN a11.MONTH 11 ELSE NULL END) WJXBFSb, sum(CASE WHEN a13.MONTH_ID>=10 THEN a11. MONTH 10 ELSE NULL END) sum(CASE WHEN a13.MONTH_ID>=9 THEN a11.MONTH_09 ELSE NULL END) WJXBFSd DWHSTG.VW_DIM_HEADCOUNT a11
from
join
where
on
join
ZZOP00 a12
(a11.LEGAL_ENTITY_CODE = a12.LEGAL_ENTITY_CODE)
OFSAATM.DIM_MONTH_YEAR
on (a11.YEAR_S = a13.YEAR_S)
a13
a14
DWHSTG.DIM_LE_CC_FN_DIV_MAP
(a11.COST_CENTER_CODE = a14.COST_CENTER_CODE and
join
on
a11.LEGAL_ENTITY_CODE
=
a14.LEGAL_ENTITY_CODE)
(a11.YEAR_S = cast (2023 as INTEGER)
and a13.MONTH_ID in (1)
and a11.SCENARIO in ('ACTUAL')
and a14.GRP in ('Retail Banking'))
group by
a11.YEAR_S,
a11.LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER,
a11.EMP_TYPE,
a11.COST CENTER_CODE
[DB Instance: MSTR OF SAAUAT_OFSAATM] create table ZZMD02 nologging as
select
a11.YEAR_S YEAR_S,
a11.LEGAL_ENTITY_CODE
LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER GRADE_ORDER,
a11.EMP_TYPE EMP_TYPE,
a11.COST_CENTER_CODE COST_CENTER_CODE,
sum (CASE WHEN a13.MONTH_ID=1 THEN a11.MONTH_01
WHEN a13.MONTH_ID=2 THEN
WHEN
a13.MONTH_ID=3 THEN
a11.MONTH_02
a11.MONTH_03
WHEN a13.MONTH_ID=4 THEN a11.MONTH_04 WHEN a13.MONTH_ID=5 THEN a11.MONTH_05 WHEN a13.MONTH_ID=6 THEN a11.MONTH_06 WHEN a13.MONTH_ID=7 THEN a11.MONTH_07 WHEN a13.MONTH_ID=8 THEN a11.MONTH_08
a13.MONTH_ID=9 THEN a13.MONTH_ID=10 THEN
WHEN
a11.MONTH_09
WHEN
a11.MONTH_10
WHEN a13.MONTH ID=11 THEN
a11.MONTH 11
WJXBFSC,

WHEN a13.MONTH_ID=12 THEN a11.MONTH 12
ELSE NULL END)
from
where
WJXBFS1
DWHSTG.VW_DIM_HEADCOUNT a11
ZZOP00 a12
(a11.LEGAL_ENTITY_CODE
=
a12.LEGAL_ENTITY_CODE)
OFSAATM.DIM_MONTH_YEAR a13
join
on
join
on
(a11.YEAR_S
join
on
a11.LEGAL ENTITY_CODE
=
a13.YEAR_S)
DWHSTG.DIM_LE_CC_FN_DIV_MAP
(a11.COST_CENTER_CODE
=
=
a14
a14.COST CENTER_CODE and a14.LEGAL ENTITY_CODE)
(a11.YEAR_S = cast (2023 as INTEGER)
and a13.MONTH_ID in (1)
and a11.SCENARIO in ('PLAN')
and a14.GRP in ('Retail Banking'))
group by
a11.YEAR_S,
a11.LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER,
a11.EMP_TYPE,
a11.COST CENTER_CODE
[DB Instance: MSTR OFSAAUAT_OFSAATM]
create table ZZMD03 nologging as
select
a11.YEAR_S YEAR_S,
a11.LEGAL_ENTITY_CODE LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER GRADE_ORDER,
a11.EMP_TYPE EMP_TYPE,
a11.COST_CENTER_CODE COST_CENTER_CODE,
sum((Case when (a11. YEAR_S
sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S
=
=
=
=
=
=
=
=
sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11.YEAR_S sum((Case when (a11. YEAR S =
=
=
=
=
cast (2023 as
cast (2023 as INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH_04 else NULL end)) WJXBFS1, cast (2023 as INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH_08 else NULL end)) WJXBFS2, INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH 12 else NULL end)) WJXBFS3, INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH_02 else NULL end)) WJXBFS4, INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH_01 else NULL end)) WJXBFS5, INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH_07 else NULL end)) WJXBF56, INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH_06 else NULL end)) WJXBF57, INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH_03 else NULL end)) WJXBFS8, INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH_05 else NULL end)) WJXBFS9, INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH _11 else NULL end)) WJXBFSa, INTEGER) and a11.SCENARIO in ('PLAN')) then a11.MONTH_10 else NULL end)) WJXBFSb, INTEGER) and a11.SCENARIO in ('PLAN')) then a11. MONTH_09 else NULL end)) WJXBFSC, INTEGER ) 1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH 04 else NULL end)) WJXBFSd,
cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as cast (2023 as
-

from
where
=
sum((Case when (a11. YEAR_S cast (2023 as
=
=
=
=
sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11.YEAR_S = sum((Case when (a11.YEAR_S = sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11. YEAR_S sum((Case when (a11.YEAR_S DWHSTG.VW_DIM_HEADCOUNT a11 ZZOP00 a12
join
on
join
on
=
=
=
cast (2023 as
cast (2023 as
cast (2023 as cast (2023 as cast (2023 as cast (2023 as
cast (2023 as
cast (2023 as cast(2023 as cast (2023 as
=
)
INTEGER) INTEGER > INTEGER) INTEGER INTEGER INTEGER INTEGER) INTEGER) INTEGER > INTEGER) INTEGER)
-
-
-
-
-
-
-
-
a12.LEGAL_ENTITY_CODE) a13
(a11.LEGAL_ENTITY_CODE DWHSTG.DIM_LE_CC_FN_DIV_MAP (a11.COST CENTER_CODE a11.LEGAL_ENTITY_CODE = a13.LEGAL_ENTITY_CODE)
(a13.GRP in ('Retail Banking')
and ((a11.YEAR_S
=
=
a13.COST CENTER_CODE and
cast (2023 as INTEGER)
and a11.SCENARIO in ('PLAN'))
or (a11.YEAR_S
=
cast (2023 as INTEGER )
and a11.SCENARIO in ('ACTUAL'))))
group by
a11.YEAR_S,
a11.LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER,
a11.EMP_TYPE,
a11.COST_CENTER_CODE
[DB Instance: MSTR OFSAAUAT_OFSAATM] create table ZZMD04 nologging as
select a11. YEAR_S YEAR_S,
-
1
a11.LEGAL_ENTITY_CODE LEGAL_ENTITY_CODE,
1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_08 else NULL end)) WJXBFSe,
1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH 12 else NULL end)) WJXBFSF,
1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH_02 else NULL end)) WJXBFS10, 1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH_01 else NULL end)) WJXBFS11,
1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_07 else NULL end)) WJXBFS12,
1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_06 else NULL end)) WJXBFS13,
1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_03 else NULL end)) WJXBFS14, 1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_05 else NULL end)) WJXBFS15, 1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH 11 else NULL end)) WJXBFS16, 1 and a11.SCENARIO in ('ACTUAL')) then a11.MONTH_10 else NULL end)) WJXBFS17,
1 and a11.SCENARIO in ('ACTUAL')) then a11. MONTH_09 else NULL end)) WJXBFS18
a12.LEGAL_ENTITY_CLASSIFICATION LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER GRADE_ORDER,
a11.EMP_TYPE EMP_TYPE,
a11.COST CENTER_CODE COST_CENTER_CODE,
sum(CASE WHEN a13.MONTH_ID=1 THEN a11.MONTH_01
WHEN a13.MONTH_ID=2 THEN
a11.MONTH_02
WHEN
a13.MONTH_ID=3 THEN
a11.MONTH_03
WHEN
a13.MONTH_ID=4 THEN
a11.MONTH_04
WHEN
a13.MONTH ID=5 THEN a11.MONTH 05

WHEN WHEN
WHEN a13.MONTH_ID=6 THEN a11.MONTH_06 a13.MONTH_ID=7 THEN a11.MONTH_07 a13.MONTH_ID=8 THEN a11.MONTH_08
WHEN
a13.MONTH_ID=9 THEN
a11.MONTH_09
WHEN
a13.MONTH_ID=10 THEN
WHEN
WHEN
ELSE NULL END)
from
where
a11.MONTH_10
a13.MONTH_ID=11 THEN a11.MONTH_11
a13.MONTH_ID=12 THEN a11.MONTH_12
WJXBFS1
DWHSTG.VW_DIM_HEADCOUNT a11
join
on
join
on
join
on
ZZOP00 a12
(a11.LEGAL_ENTITY_CODE
=
a12.LEGAL_ENTITY_CODE)
OFSAATM.DIM_MONTH_YEAR a13 (a11.YEAR_S = a13.YEAR_S)
a14
=
a14.COST CENTER_CODE and
DWHSTG.DIM_LE_CC_FN_DIV_MAP (a11.COST_CENTER_CODE
a11.LEGAL_ENTITY_CODE = a14.LEGAL_ENTITY_CODE) (a11. YEAR_S = cast (2023 as INTEGER ) - 1
and a13.MONTH_ID in (1)
and a11.SCENARIO in ('ACTUAL')
and a14.GRP in ('Retail Banking'))
group by
a11.YEAR_S,
a11.LEGAL_ENTITY_CODE,
a12.LEGAL_ENTITY_CLASSIFICATION,
a11.GRADE_ORDER,
a11.EMP_TYPE,
a11.COST CENTER_CODE
[DB Instance: MSTR_OFSAAUAT_OFSAATM]
select
distinct a16.COMPANY_NAME_ORDER COMPANY_NAME_ORDER,
a16.COMPANY_NAME
COMPANY_NAME,
coalesce(pa11.COST_CENTER_CODE, pa12.COST_CENTER_CODE, pa13.COST CENTER_CODE, pa15.COST_CENTER_CODE) COST_CENTER_CODE,
a17.COST_CENTER_DESC COST_CENTER_DESCO,
a17.COUNTRY COUNTRY,
a17.DIV DIV,
coalesce(pa11. EMP_TYPE, pa12. EMP_TYPE, pa13. EMP_TYPE, pa15. EMP_TYPE)
a17. FUNC FUNC,
EMP_TYPE,
coalesce(pa11. GRADE_ORDER, pa12.GRADE_ORDER, pa13. GRADE_ORDER, pa15.GRADE_ORDER) GRADE_ORDER,
coalesce(pa11.LEGAL_ENTITY_CLASSIFICATION, pa12. LEGAL_ENTITY_CLASSIFICATION, pa13. LEGAL_ENTITY_CLASSIFICATION, pa15.LEGAL_ENTITY_CLASSIFICATION) LEGAL_ENTITY_CLASSIFICATION, coalesce(pa11.LEGAL_ENTITY_CODE, pa12.LEGAL_ENTITY_CODE, pa13. LEGAL_ENTITY_CODE, pa15. LEGAL_ENTITY_CODE) LEGAL_ENTITY_CODE,
a16.PAYBAND_ORDER PAYBAND_ORDER,
a16. PAYBAND PAYBAND,
coalesce(pa11. YEAR S. Da12.YEAR S. Da13. YEAR S. Da15.YEAR S) YEAR S,

from
a17.GRP GRP,
pa11.WJXBFS1
WJXBFS1,
pa12.WJXBFS1 WJXBFS2,
pa11.WJXBFS2 WJXBFS3,
pa13.WJXBFS1 WJXBFS4,
pa11.WJXBFS3 WJXBFS5,
pa13.WJXBFS2 WJXBFS6,
pa11.WJXBFS4 WJXBFS7,
pa13.WJXBFS3 WJXBFS8,
pa11.WJXBFS5 WJXBFS9,
pa13.WJXBFS4 WJXBFSa,
pa11.WJXBFS6 WJXBFSb,
pa13.WJXBFS5 WJXBFSC,
pa11.WJXBFS7 WJXBFSd,
pa13.WJXBFS6 WJXBFSe,
pa11.WJXBFS8 WJXBFSF,
pa13.WJXBFS7 WJXBFS10,
pa11.WJXBFS9 WJXBFS11,
pa13.WJXBFS8 WJXBFS12,
pa11.WJXBFSa WJXBFS13,
pa13.WJXBFS9 WJXBFS14,
pa11.WJXBFSb WJXBFS15,
pa13.WJXBFSa WJXBFS16,
pa11.WJXBFSC WJXBFS17,
pa13.WJXBFSb WJXBFS18,
pa11.WJXBFSd WJXBFS19,
pa13.WJXBFSC WJXBFS1a,
pa13.WJXBFSd WJXBFS1b,
pa13.WJXBFSe WJXBFS1C,
pa13.WJXBFSF WJXBFS1d,
pa13.WJXBFS10 WJXBFS1e,
pa13.WJXBFS11 WJXBFS1f,
pa13.WJXBFS12 WJXBFS20,
pa13.WJXBFS13 WJXBFS21,
pa13.WJXBFS14 WJXBFS22,
pa13.WJXBFS15 WJXBFS23,
pa13.WJXBFS16 WJXBFS24,
pa13.WJXBFS17 WJXBFS25,
pa13.WJXBFS18 WJXBFS26,
WJXBFS27
pa15.WJXBFS1
ZZMD01 pa11
full outer join ZZMD02 pa12

pa11.EMP_TYPE pa12. EMP_TYPE and
pa11.GRADE_ORDER pa12.GRADE_ORDER and
pa11. LEGAL_ENTITY_CLASSIFICATION
pa12. LEGAL ENTITY_CLASSIFICATION and
pa11.LEGAL_ENTITY_CODE = pa12. LEGAL_ENTITY_CODE and pa11.YEAR_S = pa12.YEAR_S)
full outer join ZZMD03 pa13
on (coalesce(pa11.COST_CENTER_CODE, pa12.COST_CENTER_CODE) = pa13.COST_CENTER_CODE and coalesce(pa11. EMP_TYPE, pa12. EMP_TYPE)
=
pa13. EMP_TYPE and
pa13.GRADE_ORDER and
coalesce(pa11. GRADE_ORDER, pa12.GRADE_ORDER)
=
coalesce(pa11.LEGAL_ENTITY_CLASSIFICATION, pa12. LEGAL_ENTITY_CLASSIFICATION) = pa13. LEGAL_ENTITY_CLASSIFICATION and coalesce(pa11. LEGAL_ENTITY_CODE, pa12. LEGAL_ENTITY_CODE) = pa13. LEGAL_ENTITY_CODE and coalesce(pa11. YEAR_S, pa12.YEAR_S) = pa13.YEAR_S)
full outer join ZZMD04 pa15
on
=
pa15.GRADE_ORDER and
(coalesce(pa11.COST_CENTER_CODE, pa12.COST_CENTER_CODE, pa13.COST_CENTER_CODE) = pa15.COST_CENTER_CODE and coalesce(pa11. EMP_TYPE, pa12. EMP_TYPE, pa13. EMP_TYPE) = pa15. EMP_TYPE and coalesce(pa11. GRADE_ORDER, pa12.GRADE_ORDER, pa13.GRADE_ORDER) coalesce(pa11.LEGAL_ENTITY_CLASSIFICATION, pa12. LEGAL_ENTITY_CLASSIFICATION, pa13.LEGAL_ENTITY_CLASSIFICATION) coalesce(pa11.LEGAL_ENTITY_CODE, pa12. LEGAL_ENTITY_CODE, pa13.LEGAL_ENTITY_CODE) = pa15.LEGAL_ENTITY_CODE and coalesce(pa11.YEAR_S, pa12.YEAR_S, pa13.YEAR_S) = pa15.YEAR_S)
join
DWHSTG.VW_DIM_HC_GRADE_ORDER a16
pa15.LEGAL_ENTITY_CLASSIFICATION and
on (coalesce(pa11. GRADE_ORDER, pa12.GRADE_ORDER, pa13. GRADE_ORDER, pa15.GRADE_ORDER) = a16.GRADE_ORDER and coalesce(pa11.LEGAL_ENTITY_CLASSIFICATION, pa12.LEGAL_ENTITY_CLASSIFICATION, pa13. LEGAL_ENTITY_CLASSIFICATION, pa15.LEGAL_ENTITY_CLASSIFICATION) DWHSTG.DIM_LE_CC_FN_DIV_MAP
join
a17
on (coalesce(pa11.COST_CENTER_CODE, pa12.COST_CENTER_CODE, pa13.COST_CENTER_CODE, pa15.COST_CENTER_CODE) = a17.COST_CENTER_CODE and coalesce(pa11.LEGAL_ENTITY_CODE, pa12.LEGAL_ENTITY_CODE, pa13.LEGAL_ENTITY_CODE, pa15.LEGAL_ENTITY_CODE) = a17.LEGAL_ENTITY_CODE)
a16.GRADE_CLASSIFICATION)